{"version":3,"file":"schemes.nomodule.js","sources":["../../src/core/generated/scripts/config.js","../../src/core/api.js","../../src/schemes/scripts/scheme/constants.js","../../src/schemes/scripts/scheme/scheme.js","../../src/schemes/index.js","../../src/schemes/scripts/switch-theme/constants.js","../../src/schemes/scripts/scheme/build.js","../../src/schemes/scripts/switch-theme/switch-theme.js","../../src/schemes/scripts/switch-theme/build.js","../../src/schemes/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const SCHEME_ATTR = api.core.ns.attr('theme');\nexport const TRANSITION_ATTR = api.core.ns.attr('transition');\n","import { SCHEME_ATTR, TRANSITION_ATTR } from './constants';\n\n/**\n * TODO: implÃ©menter la valeur system\n * window.matchMedia(\"(prefers-color-scheme: dark)\").addListener(\n e => e.matches && activateDarkMode()) // listener\n );\n */\n\nclass Scheme {\n  constructor () {\n    this.init();\n  }\n\n  init () {\n    this.root = document.documentElement;\n\n    this.scheme = localStorage.getItem('scheme')\n      ? localStorage.getItem('scheme')\n      : null;\n\n    if (this.scheme === null) {\n      const scheme = this.root.getAttribute(SCHEME_ATTR);\n      if (scheme === 'dark' || scheme === 'light') {\n        this.scheme = scheme;\n      } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n        this.scheme = 'dark';\n        localStorage.setItem('scheme', 'dark');\n      } else this.scheme = 'light';\n    }\n\n    if (this.scheme === 'dark') {\n      if (!this.root.hasAttribute(TRANSITION_ATTR)) {\n        this.root.setAttribute(SCHEME_ATTR, 'dark');\n      } else {\n        this.root.removeAttribute(TRANSITION_ATTR);\n        this.root.setAttribute(SCHEME_ATTR, 'dark');\n\n        setTimeout(() => {\n          this.root.setAttribute(TRANSITION_ATTR, '');\n        }, 300);\n      }\n    } else this.root.setAttribute(SCHEME_ATTR, 'light');\n\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observer.observe(this.root, { attributes: true });\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === SCHEME_ATTR) {\n        const scheme = this.root.getAttribute(SCHEME_ATTR);\n        if (scheme === 'dark') {\n          localStorage.setItem('scheme', 'dark');\n        } else if (scheme === 'light') {\n          localStorage.setItem('scheme', 'light');\n        }\n      }\n    });\n  }\n}\n\nexport { Scheme };\n","import api from './api.js';\nimport { Scheme } from './scripts/scheme/scheme';\n\napi.Scheme = Scheme;\n","import api from '../../api.js';\n\nexport const RADIOS_THEME_NAME = `input[name=\"${api.core.ns.selector('radios-theme', '')}\"]`;\nexport const SWITCH_THEME_ID = api.core.ns.selector('switch-theme', '#');\nexport const THEME_ATTR = api.core.ns.attr('theme');\n","/* eslint-disable no-new */\nimport { Scheme } from './scheme';\n\nconst build = () => {\n  new Scheme();\n};\n\nexport default build;\n","import { RADIOS_THEME_NAME, THEME_ATTR } from './constants';\n\nclass SwitchTheme {\n  constructor () {\n    this.attributeName = THEME_ATTR;\n    this.theme = null;\n    this.radios = document.querySelectorAll(RADIOS_THEME_NAME);\n\n    for (var i = 0; i < this.radios.length; i++) {\n      this.radios[i].addEventListener('change', this.change.bind(this));\n    }\n\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observe();\n    this.apply();\n  }\n\n  observe () {\n    this.observer.observe(document.documentElement, { attributes: true });\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === this.attributeName) {\n        this.apply();\n      }\n    });\n  }\n\n  apply () {\n    const theme = document.documentElement.getAttribute(this.attributeName);\n    this.isApplying = true;\n    for (var i = 0; i < this.radios.length; i++) {\n      this.radios[i].checked = this.radios[i].value === theme;\n    }\n    this.isApplying = false;\n  }\n\n  change () {\n    if (this.isApplying) return;\n    if (this.observer) this.observer.disconnect();\n    this.theme = document.querySelector(RADIOS_THEME_NAME + ':checked');\n    if (this.theme) {\n      document.documentElement.setAttribute(this.attributeName, this.theme.value);\n    } else {\n      document.documentElement.removeAttribute(this.attributeName);\n    }\n    if (this.observer) this.observe();\n  }\n}\n\nexport { SwitchTheme };\n","/* eslint-disable no-new */\nimport { SwitchTheme } from './switch-theme';\n\nconst build = () => {\n  new SwitchTheme();\n};\n\nexport default build;\n","/* eslint-disable no-new */\nimport api from '../api.js';\nimport { SCHEME_ATTR } from './scheme/constants';\nimport { SWITCH_THEME_ID } from './switch-theme/constants';\nimport buildScheme from './scheme/build';\nimport buildSwitch from './switch-theme/build';\n\nnew api.core.Initializer(`:root[${SCHEME_ATTR}]`, [buildScheme]);\nnew api.core.Initializer(`${SWITCH_THEME_ID}`, [buildSwitch]);\n"],"names":["const","this","build","buildScheme","buildSwitch"],"mappings":"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"}