{"version":3,"file":"navigation.module.min.js","sources":["../../src/core/generated/scripts/config.js","../../src/core/api.js","../../src/navigation/scripts/navigation/constants.js","../../src/navigation/scripts/navigation/navigation.js","../../src/navigation/index.js","../../src/navigation/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const NAVIGATION_CLASS = api.core.ns('nav');\nexport const NAVIGATION_LIST_CLASS = api.core.ns('nav__list');\nexport const NAVIGATION_ITEM_CLASS = api.core.ns('nav__item');\nexport const NAVIGATION_ITEM_RIGHT_CLASS = api.core.ns('nav__item--align-right');\nexport const NAVIGATION_MENU_CLASS = api.core.ns('menu');\n","import api from '../../api.js';\nimport {\n  NAVIGATION_CLASS,\n  NAVIGATION_ITEM_CLASS,\n  NAVIGATION_LIST_CLASS,\n  NAVIGATION_MENU_CLASS,\n  NAVIGATION_ITEM_RIGHT_CLASS\n} from './constants';\n\nclass Navigation extends api.core.DisclosuresGroup {\n  constructor (id, element) {\n    super(id, element);\n\n    this.menus = [];\n\n    this.navList = element.querySelector(`.${NAVIGATION_LIST_CLASS}`);\n\n    document.addEventListener('focusout', this.focusOut.bind(this));\n    window.addEventListener('resize', this.resize.bind(this));\n    window.addEventListener('orientationchange', this.resize.bind(this));\n    this.resize();\n  }\n\n  static get selector () { return NAVIGATION_CLASS; }\n\n  add (member) {\n    super.add(member);\n\n    if (member.element.classList.contains(NAVIGATION_MENU_CLASS)) {\n      this.menus.push(new NavigationMenu(member, this.navList.getBoundingClientRect().right));\n    }\n  }\n\n  focusOut (e) {\n    requestAnimationFrame(() => {\n      if (this.current !== null && !this.current.hasFocus) this.index = -1;\n    });\n  }\n\n  get index () { return super.index; }\n\n  set index (value) {\n    if (value === -1 && this.current !== null && this.current.hasFocus) this.current.focus();\n    super.index = value;\n  }\n\n  resize () {\n    const right = this.navList.getBoundingClientRect().right;\n\n    for (const menu of this.menus) menu.place(right);\n  }\n}\n\nclass NavigationMenu {\n  constructor (collapse, right) {\n    this.initialize(collapse);\n    this.place(right);\n  }\n\n  initialize (collapse) {\n    this.element = collapse.element;\n\n    for (const button of collapse.buttons) {\n      if (!button.hasAttribute) continue;\n      this.button = button.element;\n      break;\n    }\n\n    let item = this.element.parentElement;\n    while (item) {\n      if (item.classList.contains(NAVIGATION_ITEM_CLASS)) {\n        this.item = item;\n        break;\n      }\n      item = item.parentElement;\n    }\n  }\n\n  place (right) {\n    const styles = getComputedStyle(this.element);\n    const width = parseFloat(styles.width);\n    const left = this.button.getBoundingClientRect().left;\n\n    if (left + width > right) api.core.addClass(this.item, NAVIGATION_ITEM_RIGHT_CLASS);\n    else api.core.removeClass(this.item, NAVIGATION_ITEM_RIGHT_CLASS);\n  }\n}\n\nexport { Navigation };\n","import api from './api.js';\nimport { Navigation } from './scripts/navigation/navigation';\n\napi.Navigation = Navigation;\n","import api from '../api.js';\nimport { NAVIGATION_CLASS } from './navigation/constants.js';\nimport { Navigation } from './navigation/navigation.js';\n\napi.Collapse.register(NAVIGATION_CLASS, Navigation);\n"],"names":["api","window","core","NAVIGATION_CLASS","ns","NAVIGATION_LIST_CLASS","NAVIGATION_ITEM_CLASS","NAVIGATION_ITEM_RIGHT_CLASS","NAVIGATION_MENU_CLASS","Navigation","DisclosuresGroup","[object Object]","id","element","super","this","menus","navList","querySelector","document","addEventListener","focusOut","bind","resize","selector","member","add","classList","contains","push","NavigationMenu","getBoundingClientRect","right","e","requestAnimationFrame","current","hasFocus","index","value","focus","menu","place","collapse","initialize","button","buttons","hasAttribute","item","parentElement","styles","getComputedStyle","width","parseFloat","left","addClass","removeClass","Collapse","register"],"mappings":";AACO,MCCDA,EAAMC,OAAgB,MAAK,CAAEC,KAAM,IACzCD,OAAgB,KAAID,ECDb,MAAMG,EAAmBH,EAAIE,KAAKE,GAAG,OAC/BC,EAAwBL,EAAIE,KAAKE,GAAG,aACpCE,EAAwBN,EAAIE,KAAKE,GAAG,aACpCG,EAA8BP,EAAIE,KAAKE,GAAG,0BAC1CI,EAAwBR,EAAIE,KAAKE,GAAG,QCGjD,MAAMK,UAAmBT,EAAIE,KAAKQ,iBAChCC,YAAaC,EAAIC,GACfC,MAAMF,EAAIC,GAEVE,KAAKC,MAAQ,GAEbD,KAAKE,QAAUJ,EAAQK,cAAc,IAAIb,KAEzCc,SAASC,iBAAiB,WAAYL,KAAKM,SAASC,KAAKP,OACzDd,OAAOmB,iBAAiB,SAAUL,KAAKQ,OAAOD,KAAKP,OACnDd,OAAOmB,iBAAiB,oBAAqBL,KAAKQ,OAAOD,KAAKP,OAC9DA,KAAKQ,SAGPC,sBAAyB,OAAOrB,EAEhCQ,IAAKc,GACHX,MAAMY,IAAID,GAENA,EAAOZ,QAAQc,UAAUC,SAASpB,IACpCO,KAAKC,MAAMa,KAAK,IAAIC,EAAeL,EAAQV,KAAKE,QAAQc,wBAAwBC,QAIpFrB,SAAUsB,GACRC,uBAAsB,KACC,OAAjBnB,KAAKoB,SAAqBpB,KAAKoB,QAAQC,WAAUrB,KAAKsB,OAAS,MAIvEA,YAAe,OAAOvB,MAAMuB,MAE5BA,UAAWC,IACM,IAAXA,GAAiC,OAAjBvB,KAAKoB,SAAoBpB,KAAKoB,QAAQC,UAAUrB,KAAKoB,QAAQI,QACjFzB,MAAMuB,MAAQC,EAGhB3B,SACE,MAAMqB,EAAQjB,KAAKE,QAAQc,wBAAwBC,MAEnD,IAAK,MAAMQ,KAAQzB,KAAKC,MAAOwB,EAAKC,MAAMT,IAI9C,MAAMF,EACJnB,YAAa+B,EAAUV,GACrBjB,KAAK4B,WAAWD,GAChB3B,KAAK0B,MAAMT,GAGbrB,WAAY+B,GACV3B,KAAKF,QAAU6B,EAAS7B,QAExB,IAAK,MAAM+B,KAAUF,EAASG,QAC5B,GAAKD,EAAOE,aAAZ,CACA/B,KAAK6B,OAASA,EAAO/B,QACrB,MAGF,IAAIkC,EAAOhC,KAAKF,QAAQmC,cACxB,KAAOD,GAAM,CACX,GAAIA,EAAKpB,UAAUC,SAAStB,GAAwB,CAClDS,KAAKgC,KAAOA,EACZ,MAEFA,EAAOA,EAAKC,eAIhBrC,MAAOqB,GACL,MAAMiB,EAASC,iBAAiBnC,KAAKF,SAC/BsC,EAAQC,WAAWH,EAAOE,OACnBpC,KAAK6B,OAAOb,wBAAwBsB,KAEtCF,EAAQnB,EAAOhC,EAAIE,KAAKoD,SAASvC,KAAKgC,KAAMxC,GAClDP,EAAIE,KAAKqD,YAAYxC,KAAKgC,KAAMxC,ICjFzCP,EAAIS,WAAaA,ECCjBT,EAAIwD,SAASC,SAAStD,EAAkBM"}