{"version":3,"file":"table.nomodule.min.js","sources":["../../src/core/generated/scripts/config.js","../../src/core/api.js","../../src/table/scripts/table/constants.js","../../src/table/scripts/table/table.js","../../src/table/index.js","../../src/table/scripts/table/build.js","../../src/table/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const TABLE_SELECTOR = api.core.ns.selector('table');\n// export const TABLE_CLASS = api.core.ns('table');\nexport const TABLE_SCROLLING_SELECTOR = `${api.core.ns.selector('table')}:not(${api.core.ns.selector('table--no-scroll')})`;\nexport const LEFT = 'left';\nexport const RIGHT = 'right';\nexport const SHADOW_CLASS = api.core.ns('table--shadow');\nexport const SHADOW_LEFT_CLASS = api.core.ns('table--shadow-left');\nexport const SHADOW_RIGHT_CLASS = api.core.ns('table--shadow-right');\nexport const WRAPPER_CLASS = api.core.ns('table__wrapper');\nexport const CAPTION_BOTTOM_CLASS = api.core.ns('table--caption-bottom');\nexport const SCROLL_OFFSET = 1; // valeur en px du scroll avant laquelle le shadow s'active ou se desactive\n","import api from '../../api.js';\nimport {\n  SHADOW_CLASS,\n  SHADOW_LEFT_CLASS,\n  SHADOW_RIGHT_CLASS,\n  WRAPPER_CLASS,\n  LEFT,\n  RIGHT,\n  CAPTION_BOTTOM_CLASS, SCROLL_OFFSET\n} from './constants.js';\n\nclass Table {\n  constructor (table) {\n    this.init(table);\n  }\n\n  init (table) {\n    this.table = table;\n    this.tableElem = this.table.querySelector('table');\n    this.tableContent = this.tableElem.querySelector('tbody');\n    this.isScrollable = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    this.caption = this.tableElem.querySelector('caption');\n    this.captionHeight = 0;\n    this.wrap();\n\n    const scrolling = this.change.bind(this);\n    this.tableElem.addEventListener('scroll', scrolling);\n    this.change();\n  }\n\n  change () {\n    const newScroll = this.tableContent.offsetWidth > this.tableElem.offsetWidth;\n    let firstTimeScrollable = this.tableElem.offsetWidth > this.table.offsetWidth;\n    if (newScroll || firstTimeScrollable) {\n      this.scroll();\n      this.handleCaption();\n    } else {\n      if (newScroll !== this.isScrollable) this.delete();\n    }\n    this.isScrollable = newScroll;\n    firstTimeScrollable = false;\n  }\n\n  delete () {\n    api.core.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    api.core.removeClass(this.table, SHADOW_LEFT_CLASS);\n    api.core.removeClass(this.table, SHADOW_CLASS);\n    if (this.caption) {\n      this.tableElem.style.marginTop = '';\n      this.caption.style.top = '';\n      this.tableElem.style.marginBottom = '';\n      this.caption.style.bottom = '';\n    }\n  }\n\n  scroll () {\n    api.core.addClass(this.table, SHADOW_CLASS);\n    this.setShadowPosition();\n  }\n\n  /* ajoute un wrapper autour du tableau */\n  wrap () {\n    const wrapperHtml = document.createElement('div');\n    wrapperHtml.className = WRAPPER_CLASS;\n    this.table.insertBefore(wrapperHtml, this.tableElem);\n    wrapperHtml.appendChild(this.tableElem);\n    this.tableInnerWrapper = wrapperHtml;\n  }\n\n  /* affiche les blocs shadow en fonction de la position du scroll, en ajoutant la classe visible */\n  setShadowPosition () {\n    const tableScrollLeft = this.getScrollPosition(LEFT);\n    const tableScrollRight = this.getScrollPosition(RIGHT);\n\n    // on inverse en cas de lecture droite - gauche\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      this.setShadowVisibility(RIGHT, tableScrollLeft);\n      this.setShadowVisibility(LEFT, tableScrollRight);\n    } else {\n      this.setShadowVisibility(LEFT, tableScrollLeft);\n      this.setShadowVisibility(RIGHT, tableScrollRight);\n    }\n  }\n\n  /* Donne le nombre de pixels scrollés honrizontalement dans un element scrollable */\n  getScrollPosition (side) {\n    let inverter = 1;\n    // on inverse en cas de lecture droite - gauche pour que la valeur de scroll soit toujours positive\n    if (document.documentElement.getAttribute('dir') === 'rtl') {\n      inverter = -1;\n    }\n    switch (side) {\n      case LEFT:\n        return this.tableElem.scrollLeft * inverter;\n      case RIGHT:\n        return this.tableContent.offsetWidth - this.tableElem.offsetWidth - this.tableElem.scrollLeft * inverter;\n      default:\n        return false;\n    }\n  }\n\n  /* positionne la caption en top négatif et ajoute un margin-top au wrapper */\n  handleCaption () {\n    if (this.caption) {\n      const style = getComputedStyle(this.caption);\n      const newHeight = this.caption.offsetHeight + parseInt(style.marginTop) + parseInt(style.marginBottom);\n      this.captionHeight = newHeight;\n      if (this.table.classList.contains(CAPTION_BOTTOM_CLASS)) {\n        this.tableElem.style.marginBottom = this.captionHeight + 'px';\n        this.caption.style.bottom = -this.captionHeight + 'px';\n      } else {\n        this.tableElem.style.marginTop = this.captionHeight + 'px';\n        this.caption.style.top = -this.captionHeight + 'px';\n      }\n    }\n  }\n\n  /* ajoute la classe fr-table--shadow-right ou fr-table--shadow-right sur fr-table\n   en fonction d'une valeur de scroll et du sens (right, left) */\n  setShadowVisibility (side, scrollPosition) {\n    // si on a pas scroll, ou qu'on scroll jusqu'au bout\n    if (scrollPosition <= SCROLL_OFFSET) {\n      if (side === LEFT) api.core.removeClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.core.removeClass(this.table, SHADOW_RIGHT_CLASS);\n    } else {\n      if (side === LEFT) api.core.addClass(this.table, SHADOW_LEFT_CLASS);\n      else if (side === RIGHT) api.core.addClass(this.table, SHADOW_RIGHT_CLASS);\n    }\n  }\n}\n\nexport { Table };\n","import api from './api.js';\nimport { Table } from './scripts/table/table.js';\n\napi.Table = Table;\n","import { TABLE_SCROLLING_SELECTOR } from './constants';\nimport { Table } from './table';\n\nconst tables = [];\n\nconst change = () => {\n  for (let i = 0; i < tables.length; i++) tables[i].change();\n};\n\nconst build = () => {\n  const tableNodes = document.querySelectorAll(TABLE_SCROLLING_SELECTOR);\n  for (let i = 0; i < tableNodes.length; i++) tables.push(new Table(tableNodes[i]));\n\n  window.addEventListener('resize', change);\n  window.addEventListener('orientationchange', change);\n  change();\n};\n\nexport { build };\n","/* eslint-disable no-new */\nimport api from '../api.js';\nimport { build } from './table/build.js';\nimport { TABLE_SELECTOR } from './table/constants';\n\nnew api.core.Initializer(TABLE_SELECTOR, [build]);\n"],"names":["const","api","window","core","TABLE_SELECTOR","ns","selector","TABLE_SCROLLING_SELECTOR","LEFT","RIGHT","SHADOW_CLASS","SHADOW_LEFT_CLASS","SHADOW_RIGHT_CLASS","WRAPPER_CLASS","CAPTION_BOTTOM_CLASS","Table","table","this","init","tableElem","querySelector","tableContent","isScrollable","offsetWidth","caption","captionHeight","wrap","scrolling","change","bind","addEventListener","newScroll","firstTimeScrollable","scroll","handleCaption","delete","removeClass","style","marginTop","top","marginBottom","bottom","addClass","setShadowPosition","wrapperHtml","document","createElement","className","insertBefore","appendChild","tableInnerWrapper","tableScrollLeft","getScrollPosition","tableScrollRight","documentElement","getAttribute","setShadowVisibility","side","let","inverter","scrollLeft","getComputedStyle","newHeight","offsetHeight","parseInt","classList","contains","scrollPosition","tables","i","length","Initializer","tableNodes","querySelectorAll","push"],"mappings":"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"}