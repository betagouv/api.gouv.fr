{"version":3,"file":"modal.nomodule.js","sources":["../../src/core/generated/scripts/config.js","../../src/core/api.js","../../src/modal/scripts/modal/constants.js","../../src/modal/scripts/modal/focus-trap.js","../../src/modal/scripts/modal/modals-group.js","../../src/modal/scripts/modal/modal.js","../../src/modal/index.js","../../src/modal/scripts/modal/build.js","../../src/modal/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const MODAL_SELECTOR = api.core.ns.selector('modal');\nexport const MODAL_CLASS = api.core.ns('modal');\nexport const NO_SCROLL_CLASS = api.core.ns('no-scroll');\nexport const SCROLL_SHADOW_CLASS = api.core.ns('scroll-shadow');\nexport const MODAL_BODY_SELECTOR = api.core.ns.selector('modal__body');\nexport const OFFSET_MOBILE = 32; // 32px => 8v => 2rem\n","import api from '../../api.js';\n\nconst unordereds = [\n  '[tabindex=\"0\"]',\n  'a[href]',\n  'button:not([disabled])',\n  'input:not([disabled])',\n  'select:not([disabled])',\n  'textarea:not([disabled])',\n  'audio[controls]',\n  'video[controls]',\n  '[contenteditable]:not([contenteditable=\"false\" i])',\n  'details>summary:first-of-type',\n  'details'\n];\n\nconst UNORDEREDS = unordereds.join();\n\nconst ordereds = [\n  '[tabindex]:not([tabindex=\"-1\"]):not([tabindex=\"0\"])'\n];\n\nconst ORDEREDS = ordereds.join();\n\nconst isFocusable = (element, container) => {\n  if (window.getComputedStyle(element).visibility === 'hidden') return false;\n  if (container === undefined) container = element;\n\n  while (container.contains(element)) {\n    if (window.getComputedStyle(element).display === 'none') return false;\n    element = element.parentElement;\n  }\n\n  return true;\n};\n\nclass FocusTrap {\n  constructor (onTrap, onUntrap) {\n    this.element = null;\n    this.activeElement = null;\n    this.onTrap = onTrap;\n    this.onUntrap = onUntrap;\n    this.waiting = this.wait.bind(this);\n    this.handling = this.handle.bind(this);\n    this.current = null;\n  }\n\n  get trapped () { return this.element !== null; }\n\n  trap (element) {\n    if (this.trapped) this.untrap();\n\n    this.element = element;\n    this.isTrapping = true;\n    this.wait();\n\n    if (this.onTrap) this.onTrap();\n  }\n\n  wait () {\n    if (!isFocusable(this.element)) {\n      api.core.engine.renderer.next(this.waiting);\n      return;\n    }\n\n    this.trapping();\n  }\n\n  trapping () {\n    if (!this.isTrapping) return;\n    this.isTrapping = false;\n    const focusables = this.focusables;\n    if (focusables.length) focusables[0].focus();\n    this.element.setAttribute('aria-modal', true);\n    this.element.addEventListener('keydown', this.handling);\n\n    this.stunneds = [];\n    // this.stun(document.body);\n  }\n\n  stun (node) {\n    for (const child of node.children) {\n      if (child === this.element) continue;\n      if (child.contains(this.element)) {\n        this.stun(child);\n        continue;\n      }\n      this.stunneds.push(new Stunned(child));\n    }\n  }\n\n  handle (e) {\n    if (e.keyCode !== 9) return;\n\n    const focusables = this.focusables;\n    if (focusables.length === 0) return;\n\n    const first = focusables[0];\n    const last = focusables[focusables.length - 1];\n\n    const index = focusables.indexOf(document.activeElement);\n\n    if (e.shiftKey) {\n      if (!this.element.contains(document.activeElement) || index < 1) {\n        e.preventDefault();\n        last.focus();\n      } else if (document.activeElement.tabIndex > 0 || focusables[index - 1].tabIndex > 0) {\n        e.preventDefault();\n        focusables[index - 1].focus();\n      }\n    } else {\n      if (!this.element.contains(document.activeElement) || index === focusables.length - 1 || index === -1) {\n        e.preventDefault();\n        first.focus();\n      } else if (document.activeElement.tabIndex > 0) {\n        e.preventDefault();\n        focusables[index + 1].focus();\n      }\n    }\n  }\n\n  get focusables () {\n    let unordereds = [...this.element.querySelectorAll(UNORDEREDS)];\n\n    /**\n     *  filtrage des radiobutttons de même name (la navigations d'un groupe de radio se fait à la flèche et non pas au tab\n     **/\n    const radios = [...document.documentElement.querySelectorAll('input[type=\"radio\"]')];\n\n    if (radios.length) {\n      const groups = {};\n\n      for (const radio of radios) {\n        const name = radio.getAttribute('name');\n        if (groups[name] === undefined) groups[name] = new RadioButtonGroup(name);\n        groups[name].push(radio);\n      }\n\n      unordereds = unordereds.filter((unordered) => {\n        if (unordered.tagName.toLowerCase() !== 'input' || unordered.getAttribute('type').toLowerCase() !== 'radio') return true;\n        const name = unordered.getAttribute('name');\n        return groups[name].keep(unordered);\n      });\n    }\n\n    const ordereds = [...this.element.querySelectorAll(ORDEREDS)];\n\n    ordereds.sort((a, b) => a.tabIndex - b.tabIndex);\n\n    const noDuplicates = unordereds.filter((element) => ordereds.indexOf(element) === -1);\n    const concateneds = ordereds.concat(noDuplicates);\n    return concateneds.filter((element) => element.tabIndex !== '-1' && isFocusable(element, this.element));\n  }\n\n  untrap () {\n    if (!this.trapped) return;\n    this.isTrapping = false;\n\n    this.element.removeAttribute('aria-modal');\n    this.element.removeEventListener('keydown', this.handling);\n    this.element = null;\n\n    // for (const stunned of this.stunneds) stunned.unstun();\n    // this.stunneds = [];\n\n    if (this.onUntrap) this.onUntrap();\n  }\n}\n\nclass Stunned {\n  constructor (element) {\n    this.element = element;\n    this.hidden = element.getAttribute('aria-hidden');\n    this.inert = element.getAttribute('inert');\n\n    this.element.setAttribute('aria-hidden', true);\n    this.element.setAttribute('inert', '');\n  }\n\n  unstun () {\n    if (this.hidden === null) this.element.removeAttribute('aria-hidden');\n    else this.element.setAttribute('aria-hidden', this.hidden);\n\n    if (this.inert === null) this.element.removeAttribute('inert');\n    else this.element.setAttribute('inert', this.inert);\n  }\n}\n\nclass RadioButtonGroup {\n  constructor (name) {\n    this.name = name;\n    this.buttons = [];\n  }\n\n  push (button) {\n    this.buttons.push(button);\n    if (button === document.activeElement || button.checked || this.selected === undefined) this.selected = button;\n  }\n\n  keep (button) {\n    return this.selected === button;\n  }\n}\n\nexport { FocusTrap };\n","import api from '../../api.js';\nimport { FocusTrap } from './focus-trap.js';\n\nclass ModalsGroup extends api.core.DisclosuresGroup {\n  constructor () {\n    super();\n    this.trap = new FocusTrap();\n  }\n\n  apply (value, initial) {\n    super.apply(value, initial);\n    if (this.current === null) this.trap.untrap();\n    else this.trap.trap(this.current.element);\n  }\n}\n\nexport { ModalsGroup };\n","import api from '../../api.js';\nimport {\n  OFFSET_MOBILE,\n  NO_SCROLL_CLASS,\n  MODAL_CLASS,\n  SCROLL_SHADOW_CLASS,\n  MODAL_BODY_SELECTOR\n} from './constants';\nimport { ModalsGroup } from './modals-group';\n\nconst group = new ModalsGroup();\n\nclass Modal extends api.core.Disclosure {\n  constructor (element) {\n    super(element);\n    this.body = this.element.querySelector(MODAL_BODY_SELECTOR);\n    this.scrollDistance = 0;\n    this.scrolling = this.resize.bind(this, false);\n    this.resizing = this.resize.bind(this, true);\n    this.init();\n    this.resize(true);\n  }\n\n  init () {\n    this.element.addEventListener('click', this.click.bind(this));\n\n    this.keyListener = new api.KeyListener(this.element);\n    this.keyListener.down(api.KeyListener.ESCAPE, this.conceal.bind(this), true, true);\n\n    if (this.body) {\n      this.body.addEventListener('scroll', this.scrolling);\n      window.addEventListener('resize', this.resizing);\n      // window.addEventListener('orientationchange', this.resizing);\n    }\n  }\n\n  click (e) {\n    if (this.body && this.body !== e.target && !this.body.contains(e.target)) this.conceal();\n  }\n\n  gather () {\n    group.add(this);\n  }\n\n  disclose (withhold) {\n    if (!super.disclose(withhold)) return false;\n    this.resize(true);\n    this.handleScroll(false);\n    return true;\n  }\n\n  conceal (withhold, preventFocus) {\n    if (!super.conceal(withhold, preventFocus)) return false;\n    this.handleScroll(true);\n    return true;\n  }\n\n  /**\n   * Fixe l'arrière plan quand la modal est ouverte\n   */\n  // TODO: créer une fonction de fix de scroll dans core (api.noScroll = true)\n  handleScroll (isScrollable) {\n    if (isScrollable) {\n      api.core.removeClass(document.documentElement, NO_SCROLL_CLASS);\n      document.body.style.top = '';\n      window.scroll(0, this.scrollDistance);\n    } else {\n      if (!document.documentElement.classList.contains(NO_SCROLL_CLASS)) {\n        this.scrollDistance = window.scrollY;\n      }\n      document.body.style.top = this.scrollDistance * -1 + 'px';\n      api.core.addClass(document.documentElement, NO_SCROLL_CLASS);\n    }\n  }\n\n  /**\n   * Ajoute une ombre autour du footer lorsque l'on peut scroller dans la modale\n   * corrige le 100vh, en mobile notamment, lorsque la barre navigateur est présente par exemple.\n   */\n  resize (isResizing, e) {\n    if (!this.body) return;\n    if (this.body.scrollHeight > this.body.clientHeight) {\n      if (this.body.offsetHeight + this.body.scrollTop >= this.body.scrollHeight) {\n        api.core.removeClass(this.body, SCROLL_SHADOW_CLASS);\n      } else {\n        api.core.addClass(this.body, SCROLL_SHADOW_CLASS);\n      }\n    } else {\n      api.core.removeClass(this.body, SCROLL_SHADOW_CLASS);\n    }\n\n    if (isResizing) {\n      this.body.style.maxHeight = (window.innerHeight - OFFSET_MOBILE) + 'px';\n\n      // Une deuxième fois après positionnement des barres du navigateur (ios)\n      // TODO: à tester si fonctionnel sans setTimeout\n      api.core.engine.renderer.next(() => {\n        this.body.style.maxHeight = (window.innerHeight - OFFSET_MOBILE) + 'px';\n      });\n    }\n  }\n\n  static get type () { return api.core.DISCLOSURE_TYPES.opened; }\n  static get selector () { return MODAL_CLASS; }\n\n  get GroupConstructor () { return ModalsGroup; }\n}\n\nexport { Modal };\n","import api from './api.js';\n\nimport { Modal } from './scripts/modal/modal';\nimport { ModalsGroup } from './scripts/modal/modals-group';\nimport { FocusTrap } from './scripts/modal/focus-trap';\n\napi.Modal = Modal;\napi.ModalsGroup = ModalsGroup;\napi.FocusTrap = FocusTrap;\n","import { Modal } from './modal';\n\n/**\n * initialise tout les éléments Modal dans la page\n */\nconst build = () => {\n  Modal.build(document);\n};\n\nexport { build };\n","/* eslint-disable no-new */\nimport api from '../api.js';\nimport { build } from './modal/build.js';\nimport { MODAL_SELECTOR } from './modal/constants.js';\n\nnew api.core.Initializer(MODAL_SELECTOR, [build]);\n"],"names":["const","let","this","super"],"mappings":"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"}