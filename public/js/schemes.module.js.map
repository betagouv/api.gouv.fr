{"version":3,"file":"schemes.module.js","sources":["../../src/core/generated/scripts/config.js","../../src/core/api.js","../../src/schemes/scripts/scheme/constants.js","../../src/schemes/scripts/scheme/scheme.js","../../src/schemes/index.js","../../src/schemes/scripts/switch-theme/constants.js","../../src/schemes/scripts/scheme/build.js","../../src/schemes/scripts/switch-theme/switch-theme.js","../../src/schemes/scripts/switch-theme/build.js","../../src/schemes/scripts/module.js"],"sourcesContent":["export const prefix = 'fr';\r\nexport const namespace = 'dsfr';\r\nexport const organisation = '@gouvfr';\r\n","import { namespace } from './generated/scripts/config.js';\n\nconst api = window[namespace] || { core: {} };\nwindow[namespace] = api;\nexport default api;\n","import api from '../../api.js';\n\nexport const SCHEME_ATTR = api.core.ns.attr('theme');\nexport const TRANSITION_ATTR = api.core.ns.attr('transition');\n","import { SCHEME_ATTR, TRANSITION_ATTR } from './constants';\n\n/**\n * TODO: implÃ©menter la valeur system\n * window.matchMedia(\"(prefers-color-scheme: dark)\").addListener(\n e => e.matches && activateDarkMode()) // listener\n );\n */\n\nclass Scheme {\n  constructor () {\n    this.init();\n  }\n\n  init () {\n    this.root = document.documentElement;\n\n    this.scheme = localStorage.getItem('scheme')\n      ? localStorage.getItem('scheme')\n      : null;\n\n    if (this.scheme === null) {\n      const scheme = this.root.getAttribute(SCHEME_ATTR);\n      if (scheme === 'dark' || scheme === 'light') {\n        this.scheme = scheme;\n      } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {\n        this.scheme = 'dark';\n        localStorage.setItem('scheme', 'dark');\n      } else this.scheme = 'light';\n    }\n\n    if (this.scheme === 'dark') {\n      if (!this.root.hasAttribute(TRANSITION_ATTR)) {\n        this.root.setAttribute(SCHEME_ATTR, 'dark');\n      } else {\n        this.root.removeAttribute(TRANSITION_ATTR);\n        this.root.setAttribute(SCHEME_ATTR, 'dark');\n\n        setTimeout(() => {\n          this.root.setAttribute(TRANSITION_ATTR, '');\n        }, 300);\n      }\n    } else this.root.setAttribute(SCHEME_ATTR, 'light');\n\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observer.observe(this.root, { attributes: true });\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === SCHEME_ATTR) {\n        const scheme = this.root.getAttribute(SCHEME_ATTR);\n        if (scheme === 'dark') {\n          localStorage.setItem('scheme', 'dark');\n        } else if (scheme === 'light') {\n          localStorage.setItem('scheme', 'light');\n        }\n      }\n    });\n  }\n}\n\nexport { Scheme };\n","import api from './api.js';\nimport { Scheme } from './scripts/scheme/scheme';\n\napi.Scheme = Scheme;\n","import api from '../../api.js';\n\nexport const RADIOS_THEME_NAME = `input[name=\"${api.core.ns.selector('radios-theme', '')}\"]`;\nexport const SWITCH_THEME_ID = api.core.ns.selector('switch-theme', '#');\nexport const THEME_ATTR = api.core.ns.attr('theme');\n","/* eslint-disable no-new */\nimport { Scheme } from './scheme';\n\nconst build = () => {\n  new Scheme();\n};\n\nexport default build;\n","import { RADIOS_THEME_NAME, THEME_ATTR } from './constants';\n\nclass SwitchTheme {\n  constructor () {\n    this.attributeName = THEME_ATTR;\n    this.theme = null;\n    this.radios = document.querySelectorAll(RADIOS_THEME_NAME);\n\n    for (var i = 0; i < this.radios.length; i++) {\n      this.radios[i].addEventListener('change', this.change.bind(this));\n    }\n\n    this.observer = new MutationObserver(this.mutate.bind(this));\n    this.observe();\n    this.apply();\n  }\n\n  observe () {\n    this.observer.observe(document.documentElement, { attributes: true });\n  }\n\n  mutate (mutations) {\n    mutations.forEach((mutation) => {\n      if (mutation.type === 'attributes' && mutation.attributeName === this.attributeName) {\n        this.apply();\n      }\n    });\n  }\n\n  apply () {\n    const theme = document.documentElement.getAttribute(this.attributeName);\n    this.isApplying = true;\n    for (var i = 0; i < this.radios.length; i++) {\n      this.radios[i].checked = this.radios[i].value === theme;\n    }\n    this.isApplying = false;\n  }\n\n  change () {\n    if (this.isApplying) return;\n    if (this.observer) this.observer.disconnect();\n    this.theme = document.querySelector(RADIOS_THEME_NAME + ':checked');\n    if (this.theme) {\n      document.documentElement.setAttribute(this.attributeName, this.theme.value);\n    } else {\n      document.documentElement.removeAttribute(this.attributeName);\n    }\n    if (this.observer) this.observe();\n  }\n}\n\nexport { SwitchTheme };\n","/* eslint-disable no-new */\nimport { SwitchTheme } from './switch-theme';\n\nconst build = () => {\n  new SwitchTheme();\n};\n\nexport default build;\n","/* eslint-disable no-new */\nimport api from '../api.js';\nimport { SCHEME_ATTR } from './scheme/constants';\nimport { SWITCH_THEME_ID } from './switch-theme/constants';\nimport buildScheme from './scheme/build';\nimport buildSwitch from './switch-theme/build';\n\nnew api.core.Initializer(`:root[${SCHEME_ATTR}]`, [buildScheme]);\nnew api.core.Initializer(`${SWITCH_THEME_ID}`, [buildSwitch]);\n"],"names":["build","buildScheme","buildSwitch"],"mappings":"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"}